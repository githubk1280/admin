<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.tmrasys.dao.DocumentDao">
	<insert id="insertDocument" keyProperty="fileId" parameterMap="docParameter"
		useGeneratedKeys="true">
		INSERT INTO
		document
		(FileId, FileName, FilePath,
		FileOwner, FileType, ParentId, AddTime)
		VALUES
		(#{fileId},#{fileName},#{filePath},#{fileOwner},#{fileType},#{parentId},now());
	</insert>
	<select id="loadFolderByName" resultType="int" parameterType="map">
		SELECT count(FileId) FROM document
		WHERE
		FileName=#{name}
		AND
		ParentId=#{parentId}
	</select>
	<select id="loadRootFoldersUnderUser" resultMap="docResult" 
		parameterType="map">
		SELECT * FROM document
		WHERE
		FileOwner=#{name}
		AND
		ParentId=#{parentId}
	</select>
	<resultMap type="com.tmrasys.domain.Document" id="docResult">
		<id property="fileId" column="FileId" />
		<result property="fileName" column="FileName" />
		<result property="filePath" column="FilePath" />
		<result property="fileOwner" column="FileOwner" />
		<result property="fileType" column="FileType" />
		<result property="parentId" column="ParentId" />
		<result property="addTime" column="AddTime" />
	</resultMap>
	<parameterMap type="com.tmrasys.domain.Document" id="docParameter">
		<parameter property="fileId" resultMap="FileId" />
		<parameter property="fileName" resultMap="FileName" />
		<parameter property="filePath" resultMap="FilePath" />
		<parameter property="fileOwner" resultMap="FileOwner" />
		<parameter property="fileType" resultMap="FileType" />
		<parameter property="parentId" resultMap="ParentId" />
		<parameter property="addTime" resultMap="AddTime" />
	</parameterMap>
</mapper>

